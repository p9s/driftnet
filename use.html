<article id="post-275" class="post-275 post type-post status-publish format-standard hentry category-uncategorized">
	<header class="entry-header">
		<h1 class="entry-title">同一局域网环境下的arp欺骗和中间人攻击（mac）</h1>

				<div class="entry-meta">
						<span class="sep">Posted on </span><a href="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/" title="9:13 am" rel="bookmark"><time class="entry-date" datetime="2016-03-20T09:13:50+00:00">March 20, 2016</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="https://youyuejiajia.wordpress.com/author/youyueyou/" title="View all posts by youyouyou" rel="author">youyouyou</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p>最近读了一篇有关arp欺骗和中间人攻击的文章，于是乎就想着自己实现一下，顺便验证下微信在回话劫持后的安全性。</p>
<h1><strong>1.本机环境</strong></h1>
<p><strong>Macbook Air:OS X 10.11 El Captain</strong></p>
<h1>2.推荐工具</h1>
<h2 id="nmap"><strong>Nmap（网络探测工具和安全/端口扫描器）</strong></h2>
<blockquote><p>$ brew install nmap</p></blockquote>
<h2 id="nmap"><strong>Ettercap(arp欺骗和dns欺骗工具)</strong></h2>
<blockquote><p>$ brew install ettercap –with-gtk+</p></blockquote>
<h2 id="driftnet"><strong>Driftnet（网络包图片解析器）</strong></h2>
<p>首先要安装macport（<span class="skimlinks-unlinked">https://www.macports.org/），然后在terminal</span>运行一下命令</p>
<blockquote><p>$ sudo port install driftnet</p></blockquote>
<h1>3.实施步骤</h1>
<h2>3.1 查看设备</h2>
<p>首先使用nmap工具查看同一局域网环境下的网络使用情况</p>
<blockquote><p>nmap -sP &nbsp;192.168.1.0/24</p></blockquote>
<p>效果如下：</p>
<p><img data-attachment-id="306" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-43-39-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=584" data-orig-size="564,184" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.43.39 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=584?w=564" class="alignnone size-full wp-image-306" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.43.39 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png 564w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-43-39-pm.png?w=300 300w" sizes="(max-width: 564px) 100vw, 564px"></p>
<p>这里我们可以看到同一局域网环境下，192.168.1.1是一台华硕的路由器，另外还有一部iphone，一个iWatch和一台未命名设备。我们可以看到iWatch其实是自带wifi模块，希望苹果在接下来几个watchos版本可以把这个功能开放给开发者。</p>
<h2>3.2 arp欺骗与回话劫持</h2>
<p>接下来就是强大的ettercap出场的时候了，使用以下命令启动GUI</p>
<blockquote><p>sudo ettercap -G</p></blockquote>
<p><img data-attachment-id="318" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-48-52-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=584" data-orig-size="821,516" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.48.52 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=584?w=584" class="alignnone size-full wp-image-318" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.48.52 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-48-52-pm.png 821w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p><strong>嗅探无线网卡</strong><img data-attachment-id="320" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-49-49-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=584" data-orig-size="829,526" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.49.49 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=584?w=584" class="alignnone size-full wp-image-320" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.49.49 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-49-49-pm.png 829w" sizes="(max-width: 584px) 100vw, 584px"><img data-attachment-id="321" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-50-07-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=584" data-orig-size="821,515" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.50.07 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=584?w=584" class="alignnone size-full wp-image-321" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.50.07 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-07-pm.png 821w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p><strong>遍历局域网内的设备列表</strong><img data-attachment-id="324" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-50-53-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=584" data-orig-size="818,519" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.50.53 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=584?w=584" class="alignnone size-full wp-image-324" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.50.53 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-50-53-pm.png 818w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p><img data-attachment-id="326" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-51-46-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=584" data-orig-size="814,507" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.51.46 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=584?w=584" class="alignnone size-full wp-image-326" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.51.46 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-51-46-pm.png 814w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p><strong>将像劫持的设备ip加入target 1,把网关加入target 2，启动arp欺骗</strong><img data-attachment-id="331" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-53-11-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=584" data-orig-size="823,518" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.53.11 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=584?w=584" class="alignnone size-full wp-image-331" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.53.11 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-11-pm.png 823w" sizes="(max-width: 584px) 100vw, 584px"><img data-attachment-id="332" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-4-53-32-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=584" data-orig-size="813,509" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 4.53.32 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=584?w=584" class="alignnone size-full wp-image-332" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=584" alt="Screen Shot 2016-03-20 at 4.53.32 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png?w=768 768w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-4-53-32-pm.png 813w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p>&nbsp;</p>
<p>这时候被侵入的目标设备会认为我们是网关，而网关会认为我们是被侵入的目标设备，我们扮演了一个中间人的角色。而这个工具会自动将包转发给正确的目标，在目标看来我们仿佛并不存在。大家可以用wireshark来检验是否劫持成功，因为arp的原理，欺骗的有效性并不能保证100%。大家可以多试几次。</p>
<h2>3.3 抓取图片</h2>
<p>我们使用Driftnet来检验下我们的成果，这里我只是用来检验微信的图片传输安全性与否，大家切莫用在不合法的目的上。下面的命令是监控无线网卡并且将其中的明文图片信息保存在某个文件夹中。</p>
<blockquote><p>$ driftnet -i en0 -d ~/Desktop/pic -a</p></blockquote>
<p><img data-attachment-id="348" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-5-02-11-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=584" data-orig-size="588,43" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 5.02.11 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=584?w=584" class="alignnone size-full wp-image-348" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=584" alt="Screen Shot 2016-03-20 at 5.02.11 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=584 584w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png?w=300 300w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-02-11-pm.png 588w" sizes="(max-width: 584px) 100vw, 584px"></p>
<p>&nbsp;</p>
<h1>4.验收成果</h1>
<p>由于我劫持的是我自己的iphone，用它打开微信，操作来验证<img data-attachment-id="353" data-permalink="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/screen-shot-2016-03-20-at-5-05-44-pm/" data-orig-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=584" data-orig-size="565,404" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;,&quot;orientation&quot;:&quot;0&quot;}" data-image-title="Screen Shot 2016-03-20 at 5.05.44 PM" data-image-description="" data-medium-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=584?w=300" data-large-file="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=584?w=565" class="alignnone size-full wp-image-353" src="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=584" alt="Screen Shot 2016-03-20 at 5.05.44 PM.png" srcset="https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png 565w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=150 150w, https://youyuejiajia.files.wordpress.com/2016/03/screen-shot-2016-03-20-at-5-05-44-pm.png?w=300 300w" sizes="(max-width: 565px) 100vw, 565px"></p>
<p>经过测试发现，朋友圈里的sight不会被加密，其他的图片都是加密过的。在聊天过程中的图片都是加密过的。但是有一点很奇怪，查看自己所发的朋友圈时所有的图片都是明文传输，以后大家想发private小图片到自己的朋友圈要小心点咯。Favorite里的图片也是不加密的，所以大家不要收藏些乱七八糟的东西了。^_^</p>
		<div class="wpcnt">
			<div class="wpa wpmrec" style="display: inline-block !important;">
				<span class="wpa-about">Advertisements</span>
				        <div id="crt-1258750513" style="width: 300px; height: 250px; display: none !important;"></div>
        <script type="text/javascript">
        var o = document.getElementById('crt-1258750513');
        if ("undefined"!=typeof Criteo) {
            var p = o.parentNode;
            p.style.setProperty('display', 'inline-block', 'important');
            o.style.setProperty('display', 'block', 'important');
            Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-1258750513",collapseContainerIfNotAdblocked:true,"callifnotadblocked": function () {var o = document.getElementById('crt-1258750513'); o.style.setProperty('display','none','important');o.style.setProperty('visbility','hidden','important'); }
        });
        } else {
            o.style.setProperty('display', 'none', 'important');
            o.style.setProperty('visibility', 'hidden', 'important');
        }
        </script>
				<div class="u">
								<script type="text/javascript">
				(function(g){if("undefined"!=typeof g.__ATA){g.__ATA.initAd({sectionId:26942, width:300, height:250});}})(window);
			</script><div id="automattic-id-1107" data-section="26942" style="width:300px; height:250px;"><iframe width="300" height="250" style="border: none; position: absolute; width: 0px; height: 0px; left: -10000px; top: -10000px;" frameborder="0" scrolling="no" name="dead_fif_slot_automattic-id-_automattic-id-1107" id="dead_fif_slot_automattic-id-_automattic-id-1107" src="javascript:&quot;<html><body style='background:transparent;margin:0%;'></body></html>&quot;"></iframe><iframe width="300" height="250" style="border:none;width:300px;height:250px;" frameborder="0" scrolling="no" name="fif_slot_automattic-id-_automattic-id-1107" id="fif_slot_automattic-id-_automattic-id-1107" src="javascript:&quot;<html><body style='background:transparent;margin:0%;'></body></html>&quot;"></iframe></div>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-275" class="share-twitter sd-button share-icon" href="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/?share=twitter&amp;nb=1" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-275" class="share-facebook sd-button share-icon" href="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/?share=facebook&amp;nb=1" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-275" class="share-google-plus-1 sd-button share-icon" href="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/?share=google-plus-1&amp;nb=1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-loaded" id="like-post-wrapper-99039307-275-58b42e626e508" data-src="//widgets.wp.com/likes/#blog_id=99039307&amp;post_id=275&amp;origin=youyuejiajia.wordpress.com&amp;obj_id=99039307-275-58b42e626e508" data-name="like-post-frame-99039307-275-58b42e626e508"><h3 class="sd-title">Like this:</h3><div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px; display: none;"><span class="button"><span>Like</span></span> <span class="loading">Loading...</span></div><iframe class="post-likes-widget jetpack-likes-widget" name="like-post-frame-99039307-275-58b42e626e508" height="55px" width="100%" frameborder="0" src="//widgets.wp.com/likes/#blog_id=99039307&amp;post_id=275&amp;origin=youyuejiajia.wordpress.com&amp;obj_id=99039307-275-58b42e626e508"></iframe><span class="sd-text-color"></span><a class="sd-link-color"></a></div></div>			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="https://youyuejiajia.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a> by <a href="https://youyuejiajia.wordpress.com/author/youyueyou/">youyouyou</a>. Bookmark the <a href="https://youyuejiajia.wordpress.com/2016/03/20/%e5%90%8c%e4%b8%80%e5%b1%80%e5%9f%9f%e7%bd%91%e7%8e%af%e5%a2%83%e4%b8%8b%e7%9a%84arp%e6%ac%ba%e9%aa%97%e5%92%8c%e4%b8%ad%e9%97%b4%e4%ba%ba%e6%94%bb%e5%87%bb%ef%bc%88mac%ef%bc%89/" title="Permalink to 同一局域网环境下的arp欺骗和中间人攻击（mac）" rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article>
